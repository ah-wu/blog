<meta name="viewport" content="width=device-width height=device-height initial-scale=1.0
                               minimum-scale=1.0 maximum-scale=1.0 user-scalable=no"/>
<script>
function view(it,div){
	if(it.style.textAlign=="left"){
		div.style.display="inline-block";
		it.style.textAlign="center";
	}else{
		div.style.display="none";
		it.style.textAlign="left";
	}
}
function format(text){
	/* Unfortunately, the regex expr \r\n|\r is not the same as \r|\r\n */
	let list=text.replaceAll(/\r\n|\r/g,"\n").split(/\n\n/);
	let result=document.getElementById("result");
	result.innerHTML="";
	for(let x=0; x<list.length; x=x+1){
		let div=document.createElement("div");
		let title_begin=0;
		let title_end=list[x].indexOf("\n");
		let content_begin=title_end+1;
		let title=list[x].substr(title_begin,title_end);
		let content=list[x].substr(content_begin);
		div.innerText=content;
		div.innerHTML=` ${div.innerHTML}
				<button style="display:inline-block;
					       width:100%;
					       box-shadow:none;
					       border-style:none;
					       font-size:inherit;
					       font-weight:bold;
					       color:rgba(116,44,157,1);
					       background:rgba(196,181,155,1);
					       text-align:center" 
					onclick="document.getElementById('${x}b').click()" >End of read</button>
				`;
		div.style.display="none";
		div.style.background="rgba(0,184,255,1)";
		div.id=`${x}`;
		let pdiv=document.createElement("div");
		pdiv.appendChild(div);
		pdiv.innerHTML=`<button style="display:inline-block;
					       width:100%;
					       box-shadow:none;
					       border-style:none;
					       font-size:inherit;
					       font-weight:bold;
					       color:rgba(227,76,151,1);
					       background:rgba(255,244,0,1);
					       text-align:left" 
					onclick="view(this,document.getElementById('${x}'))" id="${x}b" >${title}</button>
						${pdiv.innerHTML}
				<br><br>`;
		result.appendChild(pdiv);
	}
}
function read(title){
	xhr=new XMLHttpRequest();
	xhr.onreadystatechange=function(){
		let DONE=4;
		let OK=200;
		if(this.readyState==DONE){
			if(this.status==OK){
				format(this.responseText);
			}else{
				document.getElementById("result").innerHTML=`<h2 style="display:inline;text-align:center;color:rgba(232,0,0,1)">Not found</h2>`;
			}
		}else{
			/*PASS*/
		}
	};
	xhr.open("GET",`./${title}.txt`);
	xhr.send();
}
</script>
<body style="font-size:2em;background:rgba(0,206,0,1);">
<input type="search" style="font-size:inherit;width:100%;" oninput="read(this.value)" onchange="read(this.value)" >
<br><br>
<div id="result" style="width:100%;overflow:auto"></div>
</body>
