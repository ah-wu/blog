<meta name="viewport" content="width=device-width height=device-height initial-scale=1.0
                               minimum-scale=1.0 maximum-scale=1.0 user-scalable=no"/>
<script>
function media(id,urls){
      let div=document.createElement("div");
      div.style.display="none";
      div.id=id;
      if(urls==""){
           return div;
      }else{
            urls=urls.split(" ");
            let url=urls[0];
            urls=urls.slice(1).join(" ");
            fetch(url,{method:"HEAD"}).then(
                function(response){
                    let div=document.getElementById(id);
                    if(response.ok==true){
                         let mda=undefined;
                         let type=response.headers.get("Content-Type");
                         type=type.substr(0,type.indexOf("/"));
                         if(type=="image"){
                              mda=document.createElement("img");
                         }else if(type=="video"||type=="audio"){
                              mda=document.createElement(type);
                              mda.controls=true;
                         }else{
                              /*PASS*/
                         }
                         if(mda!=undefined){
                              mda.src=url;
                              mda.style.width="100%";
                              mda.onerror=function(){
                                              this.parentNode
                                                  .replaceChild(media(id,urls),this);
                                          };
                              div.parentNode
                                 .replaceChild(mda,div);
                         }else{
                              div.parentNode
                                 .replaceChild(media(id,urls),div);
                         }
                    }else{
                         div.parentNode
                            .replaceChild(media(id,urls),div);
                    }
                 },
                 function(error){
                     let div=document.getElementById(id);
                     div.parentNode
                        .replaceChild(media(id,urls),div);
                 });
              return div;
          }
} 
function test(it){
it.appendChild(
media(1,"test.jpg"));
it.appendChild(
media(2,"PXL_20210507_121341889.mp4"));
it.appendChild(
media(3,"GAI周延%20-%20在下霍元甲.mp3"));
it.appendChild(
media(4,"blog.txt utx.jpg test.jpg"));
it.appendChild(
media(5,"elephant.png elephant.gif"));
}
</script>
<body onload="test(document.getElementById('sh'))">
<h2>Media test</h2>
<div id="sh" ></div>
</body>
