<meta name="viewport" content="width=device-width height=device-height initial-scale=1.0
                               minimum-scale=1.0 maximum-scale=1.0 user-scalable=no"/>
<script>
function media(id,urls){
      let div=document.createElement("div");
      div.style.display="none";
      div.id=id;
      if(urls==""){
           return div;
      }else{
            urls=urls.split(/ +/);
            let url=urls[0];
            urls=urls.slice(1).join(" ");
            fetch(url,{method:"HEAD"}).then(
                function(response){
                    let div=document.getElementById(id);
                    if(response.ok==true){
                         let mda=undefined;
                         let type=response.headers.get("Content-Type");
                         type=type.substr(0,type.indexOf("/"));
                         if(type=="image"){
                              mda=document.createElement("img");
                         }else if(type=="video"||type=="audio"){
                              mda=document.createElement(type);
                              mda.controls=true;
                         }else{
                              /*PASS*/
                         }
                         if(mda!=undefined){
                              mda.src=url;
                              mda.style.width="100%";
                              mda.onerror=function(){
                                              this.parentNode
                                                  .replaceChild(media(id,urls),this);
                                          };
                              div.parentNode
                                 .replaceChild(mda,div);
                         }else{
                              div.parentNode
                                 .replaceChild(media(id,urls),div);
                         }
                    }else{
                         div.parentNode
                            .replaceChild(media(id,urls),div);
                    }
                 },
                 function(error){
                     let div=document.getElementById(id);
                     div.parentNode
                        .replaceChild(media(id,urls),div);
                 });
              return div;
          }
}
function text(id,str){
    let div=document.createElement("div");
    div.id=id;
    div.style.width="100%";
    div.innerText=str;
    return div;
}
function make(id,str){
    let strs=str.split(/\r\n|\r|\n/);
    let node=document.getElementById("");
    node.innerHTML="";
    for(let x=0; x<strs.length; x=x+1){
        str=strs[x];
        switch(str[0]){
            case "+":
               node.appendChild(media(x,str.substr(1)));
               break;
            case "=":
               str=str.substr(1);
            default:
               node.appendChild(text(x,str));
         }
     }
}
</script>
<body>
<textarea oninput="make('sh',this.value)" 
style="width:100%; overflow:auto"></textarea>
<div id="sh" ></div>
</body>
